{% load seahub_tags avatar_tags i18n %}

{% for e_group in event_groups %}

<h4 class="event-group-hd">{{ e_group.date }}</h4>
<ol class="event-group-bd">
    {% for e in e_group.events %}
    <li class="event-item">
        {% avatar e.author 36 %}
          <div class="txt" data-url="{{ e.link }}" data-time="{{ e.dtime }}"
               onclick=txtclick($(this).data("url"),$(this).data("time"))>
            {% if e.etype == "repo-update" %}
            {% with repo=e.repo commit=e.commit %} 
            <p class="w100 ovhd">
            <span class="a updated-repo normal fright">{{ repo.name }}</span>
            <span class="cmt-desc">
            {{ e.desc|translate_commit_desc|safe }}
            {% if commit.more_files %}
              <span>{% trans 'Details' %}</span>
            {% endif %}
            </span>
            </p>
            {% endwith %}
            {% endif %}

            {% if e.etype == "repo-create" %}
            <p>{% trans "Created library" %} <span class="a">{{ e.repo_name }}</span></p>
            {% endif %}

            {% if e.etype == "repo-delete" %}
            <p>{% blocktrans with library_name=e.repo_name %}Deleted library {{ library_name }}{% endblocktrans %}</p>
            {% endif %}

            <p><span class="a">{{ e.author|email2nickname }}</span> <span class="time">{{ e.time|translate_seahub_time }}</span></p>
        </div>
    </li>
    {% endfor %}
</ol>
{% endfor %}
